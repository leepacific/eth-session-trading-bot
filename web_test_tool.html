<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ§ª API í…ŒìŠ¤íŠ¸ ë„êµ¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 25px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            background: #f8f9fa;
        }
        
        .test-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.4em;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #bdc3c7;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin-right: 10px;
            margin-bottom: 10px;
            transition: transform 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
        }
        
        .results {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .result-item {
            margin-bottom: 15px;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #95a5a6;
        }
        
        .result-success {
            background: #d5f4e6;
            border-left-color: #27ae60;
        }
        
        .result-error {
            background: #fadbd8;
            border-left-color: #e74c3c;
        }
        
        .result-warning {
            background: #fef9e7;
            border-left-color: #f39c12;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }
        
        .stat-label {
            color: #7f8c8d;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ§ª API í…ŒìŠ¤íŠ¸ ë„êµ¬</h1>
            <p>íŠ¸ë ˆì´ë”© ë´‡ API ìƒíƒœ ë° ë³´ì•ˆ í…ŒìŠ¤íŠ¸</p>
        </div>
        
        <div class="content">
            <!-- API URL ì„¤ì • -->
            <div class="test-section">
                <h3>ğŸŒ API ì„¤ì •</h3>
                <div class="input-group">
                    <label for="apiUrl">API URL:</label>
                    <input type="text" id="apiUrl" placeholder="https://api.your-domain.com" 
                           value="https://api.eth-trading-bot.com">
                </div>
                <button class="btn" onclick="testConnection()">ì—°ê²° í…ŒìŠ¤íŠ¸</button>
            </div>
            
            <!-- ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ -->
            <div class="test-section">
                <h3>ğŸ” ê¸°ë³¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h3>
                <button class="btn" onclick="testHealth()">í—¬ìŠ¤ì²´í¬</button>
                <button class="btn" onclick="testStatus()">ìƒíƒœ í™•ì¸</button>
                <button class="btn" onclick="testNotFound()">404 í…ŒìŠ¤íŠ¸</button>
                <button class="btn btn-success" onclick="runAllBasicTests()">ì „ì²´ ê¸°ë³¸ í…ŒìŠ¤íŠ¸</button>
            </div>
            
            <!-- Rate Limiting í…ŒìŠ¤íŠ¸ -->
            <div class="test-section">
                <h3>âš¡ Rate Limiting í…ŒìŠ¤íŠ¸</h3>
                <div class="input-group">
                    <label for="requestCount">ìš”ì²­ ìˆ˜:</label>
                    <input type="number" id="requestCount" value="20" min="1" max="100">
                </div>
                <button class="btn btn-danger" onclick="testRateLimit()">Rate Limit í…ŒìŠ¤íŠ¸</button>
                <p style="margin-top: 10px; color: #7f8c8d; font-size: 0.9em;">
                    âš ï¸ ì´ í…ŒìŠ¤íŠ¸ëŠ” ì„œë²„ì— ë¶€í•˜ë¥¼ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
            </div>
            
            <!-- ë³´ì•ˆ í…ŒìŠ¤íŠ¸ -->
            <div class="test-section">
                <h3>ğŸ›¡ï¸ ë³´ì•ˆ í…ŒìŠ¤íŠ¸</h3>
                <button class="btn" onclick="testSecurity()">ë³´ì•ˆ í—¤ë” í™•ì¸</button>
                <button class="btn" onclick="testSSL()">SSL ì¸ì¦ì„œ í™•ì¸</button>
                <button class="btn" onclick="testCloudflare()">Cloudflare í™•ì¸</button>
            </div>
            
            <!-- ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ -->
            <div class="test-section">
                <h3>âš¡ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸</h3>
                <button class="btn" onclick="testPerformance()">ì‘ë‹µ ì‹œê°„ ì¸¡ì •</button>
                <button class="btn" onclick="testThroughput()">ì²˜ë¦¬ëŸ‰ í…ŒìŠ¤íŠ¸</button>
            </div>
            
            <!-- ë¡œë”© í‘œì‹œ -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘...</p>
            </div>
            
            <!-- ê²°ê³¼ í‘œì‹œ -->
            <div class="results" id="results" style="display: none;">
                <h3>ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3>
                <div id="resultContent"></div>
                
                <!-- í†µê³„ -->
                <div class="stats" id="stats" style="display: none;">
                    <div class="stat-card">
                        <div class="stat-number" id="successCount">0</div>
                        <div class="stat-label">ì„±ê³µí•œ í…ŒìŠ¤íŠ¸</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="failCount">0</div>
                        <div class="stat-label">ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="avgResponseTime">0ms</div>
                        <div class="stat-label">í‰ê·  ì‘ë‹µì‹œê°„</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalTests">0</div>
                        <div class="stat-label">ì´ í…ŒìŠ¤íŠ¸ ìˆ˜</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let testResults = [];
        let responseTimes = [];

        function showLoading() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('results').style.display = 'block';
        }

        function addResult(test, success, message, responseTime = null) {
            const result = {
                test,
                success,
                message,
                responseTime,
                timestamp: new Date().toLocaleTimeString()
            };
            
            testResults.push(result);
            if (responseTime) responseTimes.push(responseTime);
            
            const resultDiv = document.createElement('div');
            resultDiv.className = `result-item ${success ? 'result-success' : 'result-error'}`;
            
            let content = `
                <strong>${success ? 'âœ…' : 'âŒ'} ${test}</strong><br>
                ${message}<br>
                <small>ì‹œê°„: ${result.timestamp}</small>
            `;
            
            if (responseTime) {
                content += `<br><small>ì‘ë‹µì‹œê°„: ${responseTime}ms</small>`;
            }
            
            resultDiv.innerHTML = content;
            document.getElementById('resultContent').appendChild(resultDiv);
            
            updateStats();
        }

        function updateStats() {
            const successCount = testResults.filter(r => r.success).length;
            const failCount = testResults.filter(r => !r.success).length;
            const avgResponseTime = responseTimes.length > 0 
                ? Math.round(responseTimes.reduce((a, b) => a + b, 0) / responseTimes.length)
                : 0;
            
            document.getElementById('successCount').textContent = successCount;
            document.getElementById('failCount').textContent = failCount;
            document.getElementById('avgResponseTime').textContent = avgResponseTime + 'ms';
            document.getElementById('totalTests').textContent = testResults.length;
            document.getElementById('stats').style.display = 'grid';
        }

        function clearResults() {
            testResults = [];
            responseTimes = [];
            document.getElementById('resultContent').innerHTML = '';
            document.getElementById('stats').style.display = 'none';
        }

        async function makeRequest(endpoint, method = 'GET') {
            const baseUrl = document.getElementById('apiUrl').value.replace(/\/$/, '');
            const url = baseUrl + endpoint;
            
            const startTime = performance.now();
            
            try {
                const response = await fetch(url, {
                    method: method,
                    mode: 'cors'
                });
                
                const endTime = performance.now();
                const responseTime = Math.round(endTime - startTime);
                
                let responseData = null;
                try {
                    responseData = await response.json();
                } catch (e) {
                    responseData = await response.text();
                }
                
                return {
                    success: true,
                    status: response.status,
                    responseTime,
                    data: responseData,
                    headers: Object.fromEntries(response.headers.entries())
                };
            } catch (error) {
                const endTime = performance.now();
                const responseTime = Math.round(endTime - startTime);
                
                return {
                    success: false,
                    error: error.message,
                    responseTime
                };
            }
        }

        async function testConnection() {
            clearResults();
            showLoading();
            
            const result = await makeRequest('/health');
            
            if (result.success) {
                addResult('ì—°ê²° í…ŒìŠ¤íŠ¸', true, `ì—°ê²° ì„±ê³µ (${result.status})`, result.responseTime);
            } else {
                addResult('ì—°ê²° í…ŒìŠ¤íŠ¸', false, `ì—°ê²° ì‹¤íŒ¨: ${result.error}`, result.responseTime);
            }
            
            hideLoading();
        }

        async function testHealth() {
            const result = await makeRequest('/health');
            
            if (result.success && result.status === 200) {
                addResult('í—¬ìŠ¤ì²´í¬', true, 'í—¬ìŠ¤ì²´í¬ ì •ìƒ', result.responseTime);
            } else {
                addResult('í—¬ìŠ¤ì²´í¬', false, `í—¬ìŠ¤ì²´í¬ ì‹¤íŒ¨ (${result.status || result.error})`, result.responseTime);
            }
        }

        async function testStatus() {
            const result = await makeRequest('/status');
            
            if (result.success && result.status === 200) {
                addResult('ìƒíƒœ í™•ì¸', true, 'ìƒíƒœ í™•ì¸ ì •ìƒ', result.responseTime);
            } else {
                addResult('ìƒíƒœ í™•ì¸', false, `ìƒíƒœ í™•ì¸ ì‹¤íŒ¨ (${result.status || result.error})`, result.responseTime);
            }
        }

        async function testNotFound() {
            const result = await makeRequest('/nonexistent');
            
            if (result.success && result.status === 404) {
                addResult('404 í…ŒìŠ¤íŠ¸', true, '404 ì‘ë‹µ ì •ìƒ', result.responseTime);
            } else {
                addResult('404 í…ŒìŠ¤íŠ¸', false, `ì˜ˆìƒê³¼ ë‹¤ë¥¸ ì‘ë‹µ (${result.status || result.error})`, result.responseTime);
            }
        }

        async function runAllBasicTests() {
            clearResults();
            showLoading();
            
            await testHealth();
            await testStatus();
            await testNotFound();
            
            hideLoading();
        }

        async function testRateLimit() {
            const requestCount = parseInt(document.getElementById('requestCount').value);
            
            clearResults();
            showLoading();
            
            addResult('Rate Limit í…ŒìŠ¤íŠ¸', true, `${requestCount}ê°œ ìš”ì²­ ì‹œì‘...`);
            
            const promises = [];
            for (let i = 0; i < requestCount; i++) {
                promises.push(makeRequest('/health'));
            }
            
            const results = await Promise.all(promises);
            
            const successCount = results.filter(r => r.success && r.status === 200).length;
            const rateLimitedCount = results.filter(r => r.success && r.status === 429).length;
            const errorCount = results.filter(r => !r.success).length;
            
            addResult('Rate Limit ê²°ê³¼', true, 
                `ì„±ê³µ: ${successCount}, Rate Limited: ${rateLimitedCount}, ì˜¤ë¥˜: ${errorCount}`);
            
            if (rateLimitedCount > 0) {
                addResult('Rate Limiting', true, 'Rate Limitingì´ ì •ìƒ ì‘ë™ ì¤‘');
            } else {
                addResult('Rate Limiting', false, 'Rate Limitingì´ ê°ì§€ë˜ì§€ ì•ŠìŒ');
            }
            
            hideLoading();
        }

        async function testSecurity() {
            const result = await makeRequest('/health');
            
            if (result.success) {
                const headers = result.headers;
                
                const securityChecks = {
                    'HTTPS': document.getElementById('apiUrl').value.startsWith('https://'),
                    'Cloudflare': headers.server && headers.server.toLowerCase().includes('cloudflare'),
                    'CF-Ray': !!headers['cf-ray'],
                    'Strict-Transport-Security': !!headers['strict-transport-security'],
                    'X-Frame-Options': !!headers['x-frame-options'],
                    'X-Content-Type-Options': !!headers['x-content-type-options']
                };
                
                for (const [check, passed] of Object.entries(securityChecks)) {
                    addResult(`ë³´ì•ˆ: ${check}`, passed, passed ? 'í†µê³¼' : 'ë¯¸ì ìš©');
                }
            } else {
                addResult('ë³´ì•ˆ í…ŒìŠ¤íŠ¸', false, 'ë³´ì•ˆ í—¤ë” í™•ì¸ ì‹¤íŒ¨');
            }
        }

        async function testSSL() {
            const url = document.getElementById('apiUrl').value;
            
            if (url.startsWith('https://')) {
                addResult('SSL í…ŒìŠ¤íŠ¸', true, 'HTTPS ì—°ê²° í™•ì¸ë¨');
            } else {
                addResult('SSL í…ŒìŠ¤íŠ¸', false, 'HTTPSê°€ ì•„ë‹Œ ì—°ê²°');
            }
        }

        async function testCloudflare() {
            const result = await makeRequest('/health');
            
            if (result.success) {
                const isCloudflare = result.headers['cf-ray'] || 
                                   (result.headers.server && result.headers.server.toLowerCase().includes('cloudflare'));
                
                if (isCloudflare) {
                    addResult('Cloudflare í…ŒìŠ¤íŠ¸', true, 'Cloudflare í”„ë¡ì‹œ ê°ì§€ë¨');
                } else {
                    addResult('Cloudflare í…ŒìŠ¤íŠ¸', false, 'Cloudflare í”„ë¡ì‹œê°€ ê°ì§€ë˜ì§€ ì•ŠìŒ');
                }
            } else {
                addResult('Cloudflare í…ŒìŠ¤íŠ¸', false, 'Cloudflare í™•ì¸ ì‹¤íŒ¨');
            }
        }

        async function testPerformance() {
            clearResults();
            showLoading();
            
            const testCount = 10;
            addResult('ì„±ëŠ¥ í…ŒìŠ¤íŠ¸', true, `${testCount}íšŒ ìš”ì²­ìœ¼ë¡œ ì„±ëŠ¥ ì¸¡ì • ì‹œì‘...`);
            
            const times = [];
            
            for (let i = 0; i < testCount; i++) {
                const result = await makeRequest('/health');
                if (result.success) {
                    times.push(result.responseTime);
                }
            }
            
            if (times.length > 0) {
                const avgTime = Math.round(times.reduce((a, b) => a + b, 0) / times.length);
                const minTime = Math.min(...times);
                const maxTime = Math.max(...times);
                
                addResult('ì„±ëŠ¥ ê²°ê³¼', true, 
                    `í‰ê· : ${avgTime}ms, ìµœì†Œ: ${minTime}ms, ìµœëŒ€: ${maxTime}ms`);
                
                if (avgTime < 500) {
                    addResult('ì„±ëŠ¥ í‰ê°€', true, 'ìš°ìˆ˜í•œ ì„±ëŠ¥');
                } else if (avgTime < 1000) {
                    addResult('ì„±ëŠ¥ í‰ê°€', true, 'ì–‘í˜¸í•œ ì„±ëŠ¥');
                } else {
                    addResult('ì„±ëŠ¥ í‰ê°€', false, 'ì„±ëŠ¥ ê°œì„  í•„ìš”');
                }
            } else {
                addResult('ì„±ëŠ¥ í…ŒìŠ¤íŠ¸', false, 'ì„±ëŠ¥ ì¸¡ì • ì‹¤íŒ¨');
            }
            
            hideLoading();
        }

        async function testThroughput() {
            clearResults();
            showLoading();
            
            const duration = 5000; // 5ì´ˆ
            const startTime = Date.now();
            let requestCount = 0;
            
            addResult('ì²˜ë¦¬ëŸ‰ í…ŒìŠ¤íŠ¸', true, '5ì´ˆê°„ ì²˜ë¦¬ëŸ‰ ì¸¡ì • ì‹œì‘...');
            
            while (Date.now() - startTime < duration) {
                await makeRequest('/health');
                requestCount++;
            }
            
            const actualDuration = Date.now() - startTime;
            const throughput = Math.round((requestCount / actualDuration) * 1000);
            
            addResult('ì²˜ë¦¬ëŸ‰ ê²°ê³¼', true, `${requestCount}ê°œ ìš”ì²­, ${throughput} req/s`);
            
            hideLoading();
        }
    </script>
</body>
</html>